<main class="main">
   <!-- Page Title -->
    <div class="page-title light-background">
      <div class="container d-lg-flex justify-content-between align-items-center">
        <h1 class="mb-2 mb-lg-0">Register</h1>
        <nav class="breadcrumbs">
          <ol>
            <li><a routerLink="/Home">Trang chủ</a></li>
            <li class="current">Register</li>
          </ol>
        </nav>
      </div>
    </div><!-- End Page Title -->

  <section id="register" class="register section">
    <div class="container" data-aos="fade-up" data-aos-delay="100">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="registration-form-wrapper">
            <div class="form-header text-center">
              <h2>Đăng ký thẻ</h2>
            </div>

            <div class="row">
              <div class="col-lg-8 mx-auto">
                <form (ngSubmit)="onSubmit()" #registerForm="ngForm">

                  <!-- Tên đăng nhập -->
                  <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="tenDangNhap"
                      name="tenDangNhap" [(ngModel)]="model.TenDangNhap"
                      placeholder="Tên đăng nhập" required #tenDangNhap="ngModel" />
                    <label for="tenDangNhap">Tên đăng nhập</label>
                  </div>
                  <div class="text-danger small" *ngIf="tenDangNhap.invalid && tenDangNhap.touched">
                    ⚠️ Vui lòng nhập tên đăng nhập.
                  </div>

                  <!-- Password -->
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="matKhau"
                      name="matKhau" [(ngModel)]="model.MatKhau"
                      placeholder="Mật khẩu" required minlength="8" #matKhau="ngModel" />
                    <label for="matKhau">Mật khẩu</label>
                  </div>
                  <div class="text-danger small" *ngIf="matKhau.invalid && matKhau.touched">
                    ⚠️ Mật khẩu phải có ít nhất 8 ký tự.
                  </div>

                  <!-- Xác nhận mật khẩu -->
                  <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="confirmPassword"
                      name="confirmPassword" [(ngModel)]="confirmPassword"
                      placeholder="Xác nhận mật khẩu" required minlength="8"
                      #confirmPasswordCtrl="ngModel" />
                    <label for="confirmPassword">Xác nhận mật khẩu</label>
                  </div>
                  <div class="text-danger small" *ngIf="confirmPasswordCtrl.invalid && confirmPasswordCtrl.touched">
                    ⚠️ Vui lòng nhập lại mật khẩu (ít nhất 8 ký tự).
                  </div>
                  <div class="text-danger small" *ngIf="model.MatKhau && confirmPassword && model.MatKhau !== confirmPassword">
                    ⚠️ Mật khẩu xác nhận không khớp.
                  </div>

                  <!-- Vai trò
                  <div class="form-floating mb-4">
                    <select class="form-select" id="vaiTro" name="vaiTro"
                      [(ngModel)]="model.VaiTro" required #vaiTro="ngModel">
                      <option value="" disabled selected>-- Chọn vai trò --</option>
                      <option value="DocGia">Độc giả</option>
                      <option value="NhanVien">Nhân viên</option>
                      <option value="Admin">Admin</option>
                    </select>
                    <label for="vaiTro">Vai trò</label>
                  </div>
                  <div class="text-danger small" *ngIf="vaiTro.invalid && vaiTro.touched">
                    ⚠️ Vui lòng chọn vai trò.
                  </div> -->

                  <!-- ======================== -->
                  <!-- Thông tin độc giả thêm vào -->
                  <!-- ======================== -->

                  <!-- Họ tên -->
                  <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="hoTen"
                      name="hoTen" [(ngModel)]="model.HoTen"
                      placeholder="Họ và tên" required #hoTen="ngModel" />
                    <label for="hoTen">Họ và tên</label>
                  </div>
                  <div class="text-danger small" *ngIf="hoTen.invalid && hoTen.touched">
                    ⚠️ Vui lòng nhập họ tên.
                  </div>

                  <!-- Ngày sinh -->
                  <div class="form-floating mb-3">
                    <input type="date" class="form-control" id="ngaySinh"
                      name="ngaySinh" [(ngModel)]="model.NgaySinh"
                      placeholder="Ngày sinh" #ngaySinh="ngModel" />
                    <label for="ngaySinh">Ngày sinh</label>
                  </div>

                  <!-- Địa chỉ -->
                  <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="diaChi"
                      name="diaChi" [(ngModel)]="model.DiaChi"
                      placeholder="Địa chỉ" #diaChi="ngModel" />
                    <label for="diaChi">Địa chỉ</label>
                  </div>

                  <!-- Email -->
                  <!-- Email -->
                  <div class="form-floating mb-3">
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      name="email"
                      [(ngModel)]="model.Email"
                      placeholder="Email"
                      required
                      pattern="^[a-zA-Z0-9._%+-]+&#64;gmail\.com$"
                      #email="ngModel"
                    />
                    <label for="email">Email (chỉ chấp nhận Gmail)</label>
                  </div>
                  <div class="text-danger small" *ngIf="email.invalid && email.touched">
                    <div *ngIf="email.errors?.['required']">⚠️ Vui lòng nhập email.</div>
                    <div *ngIf="email.errors?.['pattern']">❌ Email phải là địa chỉ Gmail hợp lệ (vd: ten&#64;gmail.com).</div>
                  </div>

                  <!-- Số điện thoại -->
                  <div class="form-floating mb-4">
                    <input
                      type="text"
                      class="form-control"
                      id="soDT"
                      name="soDT"
                      [(ngModel)]="model.SoDT"
                      placeholder="Số điện thoại"
                      pattern="^0[0-9]{9}$"
                      #soDT="ngModel"
                    />
                    <label for="soDT">Số điện thoại</label>
                  </div>
                  <div class="text-danger small" *ngIf="soDT.invalid && soDT.touched">
                    ❌ Số điện thoại không hợp lệ. Vui lòng nhập 10 chữ số bắt đầu bằng 0.
                  </div>

                  <!-- Điều khoản -->
                  <div class="form-check mb-4">
                    <input class="form-check-input" type="checkbox"
                      id="termsCheck" name="termsCheck"
                      [(ngModel)]="model.TermsAccepted" required #termsCheck="ngModel" />
                    <label class="form-check-label" for="termsCheck">
                      Tôi đồng ý với <a href="#">Điều khoản dịch vụ</a> và <a href="#">Chính sách bảo mật</a>
                    </label>
                  </div>
                  <div class="text-danger small" *ngIf="termsCheck.invalid && termsCheck.touched">
                    ⚠️ Bạn phải đồng ý với điều khoản.
                  </div>

                  <!-- Nút đăng ký -->
                  <div class="d-grid mb-4">
                    <button type="submit" class="btn btn-register"
                      [disabled]="registerForm.invalid || loading">
                      {{ loading ? 'Đang tạo...' : 'Tạo thẻ' }}
                    </button>
                  </div>

                  <!-- Thông báo tổng quát -->
                  <div *ngIf="message" class="alert alert-info mt-3 text-center">
                    {{ message }}
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
